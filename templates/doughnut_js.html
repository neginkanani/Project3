<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Add your Preference</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">
  <link rel="stylesheet" href="./static/css/style.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>

<body>
  <div class="b-example-divider"></div>
  <div class="container">
    <div class="row">
      <div class="col-sm-6 col-md-4 col-lg-3"> </div>
    <header class="d-flex justify-content-left py-8">
      <ul class="nav nav-pills">
        <li class="nav-item"><a href="/" class="nav-link active" aria-current="page" style="color: black;">Home</a></li>
        <li class="nav-item"><a href="breweries.html" class="nav-link" style="color: black;">Breweries</a></li>
        <li class="nav-item"><a href="bar_chartjs_lib.html" class="nav-link" style="color: black;">MicroB Info</a></li>
        <li class="nav-item"><a href="faq.html" class="nav-link" style="color: black;">FAQs</a></li>
        <li class="nav-item"><a href="about.html" class="nav-link" style="color: black;">About</a></li>
      </ul>
      <hr></hr>
    </header>

    <!-- Jumbotron -->
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <div class="well jumbotron text-center w-100" style="background-color: #bd8b41;">
          <!-- <div id="logo"><img src="/static/img/beer.png"> -->
            <h1 style="font-family:georgia,garamond,serif;color:black">Frequently Asked Questions</h1>

        </div>
    <style>
      * {
        margin: 0;
        padding: 0;
        font-family: sans-serif;
      }
      .chartMenu {
        width: 100vw;
        height: 40px;
        background: #1A1A1A;
        color: rgb(176, 118, 23);
      }
      .chartMenu p {
        padding: 10px;
        font-size: 20px;
      }
      .chartCard {
        width: 100vw;
        height: calc(100vh - 40px);
        background: rgba(255, 255, 255, 0.2);
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .chartBox {
        width: 60%;
        padding: 20px;
        border-radius: 20px;
        border: solid 3px rgb(0, 4, 6);
        background: white;
      }

    #scoreInput {
      font-size: 35px;
      font-weight: bolder;
      text-align: center;
      border: 0;
      outline: 0;
    }

    </style>
  </head>
  <body>
    
    <div class="chartCard">
      <div class="chartBox">
        <canvas id="myChart"></canvas>
      </div>
    </div>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js"></script>
    <script>
    // setup data block
    
    const data = {
      labels: ['Mon', '', ],
      datasets: [{
        label: 'Types of Breweries',
        // two values
        data: [90, 10],
        backgroundColor: [
          'rgba(255, 26, 104, 0.2)', //90% has color
          'transparent'
        ],
        borderColor: [
          'rgba(255, 26, 104, 1)', 
          'transparent'
        ],
        borderWidth: 1,
        cutout: '95%',
        borderRadius: 10
      }]
    };

    // config 
    const config = {
      //typr
      type: 'doughnut',
      data,
      options: {
        //this is a chartjs command that resizes to the right porportion
        onResize: (context) => {
          //extract an input if it exists
            let scoreInput = document.getElementById("scoreInput");
            const width = 75;
            const height = 50;
            // console.log(context)
          //if there is no score input-- create one.
          if (!scoreInput) {
            scoreInput = document.createElement("input");
            scoreInput.id = 'scoreInput';
            //soft coded from the data set
            //designing the input and placing it appropriately
            scoreInput.value = context.data.datasets[0].data[0];
            scoreInput.type = 'number';
            scoreInput.min = 0;
            scoreInput.max = 100;
            scoreInput.style.width = `${width}px`;
            scoreInput.style.height = `${height}px`;
            scoreInput.style.position = 'relative'
            scoreInput.classList.add('score');
            //append to parent not the child element of canvas
            context.canvas.parentNode.appendChild(scoreInput)
          }
          //if it is creative once then athe above then move box inside
          //find the midpoint of the page
          const xPos = context.width / 2 - (width/2);
          const yPos = context.height / 2 * -1- (height/2);
          scoreInput.style.left = xPos + 'px';
          scoreInput.style.top = yPos + 'px';

        },
    
        plugins: {
            tooltip:{
                enabled:false
            },
                //remove the legned box so that the doughnut chart is 
            legend: {
              display: false
            }
        }
      }
    };

    // render init block
    const myChart = new Chart(
      document.getElementById('myChart'),
      config
    );
    //ge input the chart will trigger based on our input
    document.getElementById('scoreInput').addEventListener('input', (e)=> {
      percentage(document.getElementById('scoreInput'), myChart)
    });
    //make the input in the center actually change the doughnut
    function percentage (score, chart){
      console.log(score.value)
      //we need to grab the data here in order to move the input
      const { data } = chart;
      //fixes the ability to go under 0
      if (score.value >= 0 && score.value < 100){
        data.datasets[0].data[0] = score.value;
        data.datasets[0].data[1] = 100 - score.value;
      } else if(score.value >= 100 ){
        data.datasets[0].data[0] = 100;
        data.datasets[0].data[1] = 0;
        document.getElementById('scoreInput').value = 100;
      }else{
        data.datasets[0].data[0] = 0;
        data.datasets[0].data[1] = 100;
        document.getElementById('scoreInput').value = 0;

      }
      
      chart.update()


    }



    // Instantly assign Chart.js version
    const chartVersion = document.getElementById('chartVersion');
    chartVersion.innerText = Chart.version;
    </script>

  </body>
</html>